/* =========================================
    Module: SMS
========================================= */

/* Light mode defaults */
:root {
    /* Colours */
    --msg-in-bg: #2fa84f;
    --msg-in-strip-bg: #1f7a3a;
    --msg-in-strip-fg: #e0ffe0;

    --msg-out-bg: #2f6fa8;
    --msg-out-strip-bg: #1f4f7a;
    --msg-out-strip-fg: #e0f0ff;

    --msg-fg: #ffffff;
    --msg-timestamp: #555;

    /* Layout + motion */
    --msg-wrapper-max-width: 70%;
    --msg-enter-offset-y: 4px;
    --msg-enter-duration: 0.35s;
    --msg-enter-ease: ease;

    /* Bubble */
    --msg-bubble-radius: 16px;
    --msg-bubble-notch-radius: 4px;
    --msg-bubble-font-size: 0.65em;
    --msg-bubble-line-height: 1.4;

    /* Tail */
    --msg-tail-offset: -7px;
    --msg-tail-bottom: 1px;
    --msg-tail-size: 8px;

    /* Nickname strip */
    --msg-strip-font-size: 0.9em;
    --msg-strip-font-weight: 700;
    --msg-strip-opacity: 0.85;
    --msg-strip-margin-bottom: 4px;
    --msg-strip-padding: 2px 4px 0;
    --msg-strip-radius: 12px 12px 0 0;

    /* Text */
    --msg-text-padding: 6px 10px;
    --msg-text-align: justify;
    --msg-out-text-padding-right: 22px;

    /* Timestamp */
    --msg-timestamp-font-size: 0.8em;
    --msg-timestamp-margin-top: 2px;
    --msg-timestamp-align: right;
}

/* Wrapper aligns bubble + timestamp */
.message-wrapper {
    display: flex;
    flex-direction: column;
    max-width: var(--msg-wrapper-max-width);

    opacity: 0;
    transform: translateY(var(--msg-enter-offset-y));
    transition:
        opacity var(--msg-enter-duration) var(--msg-enter-ease),
        transform var(--msg-enter-duration) var(--msg-enter-ease);

    &.in {
        align-self: flex-end;
        align-items: flex-end;
    }

    &.out {
        align-self: flex-start;
        align-items: flex-start;
    }

    &.show {
        opacity: 1;
        transform: translateY(0);
    }

    .timestamp {
        font-size: var(--msg-timestamp-font-size);
        color: var(--msg-timestamp);
        margin-top: var(--msg-timestamp-margin-top);
        text-align: var(--msg-timestamp-align);

        &.in {
            align-self: flex-start;
        }

        &.out {
            align-self: flex-end;
        }
    }
}

/* Bubble */
.message {
    border-radius: var(--msg-bubble-radius);
    color: var(--msg-fg);
    font-size: var(--msg-bubble-font-size);
    line-height: var(--msg-bubble-line-height);

    position: relative;

    word-wrap: break-word;
    overflow-wrap: break-word;

    width: fit-content;
    max-width: 100%;

    .message-text {
        padding: var(--msg-text-padding);
        text-align: var(--msg-text-align);
    }

    .nickname-strip {
        font-size: var(--msg-strip-font-size);
        font-weight: var(--msg-strip-font-weight);
        opacity: var(--msg-strip-opacity);

        margin-bottom: var(--msg-strip-margin-bottom);
        padding: var(--msg-strip-padding);

        border-radius: var(--msg-strip-radius);
        text-align: left;
    }

    /* In (guest) */
    &.in {
        background-color: var(--msg-in-bg);
        border-bottom-right-radius: var(--msg-bubble-notch-radius);

        &::after {
            content: "";
            position: absolute;
            right: var(--msg-tail-offset);
            bottom: var(--msg-tail-bottom);

            width: 0;
            height: 0;

            border-left: var(--msg-tail-size) solid var(--msg-in-bg);
            border-top: var(--msg-tail-size) solid transparent;
            border-bottom: var(--msg-tail-size) solid transparent;
        }

        .nickname-strip {
            color: var(--msg-in-strip-fg);
            background: var(--msg-in-strip-bg);
        }
    }

    /* Out (host) */
    &.out {
        background-color: var(--msg-out-bg);
        border-bottom-left-radius: var(--msg-bubble-notch-radius);

        .message-text {
            position: relative;
            padding-right: var(--msg-out-text-padding-right);
        }

        &::after {
            content: "";
            position: absolute;
            left: var(--msg-tail-offset);
            bottom: var(--msg-tail-bottom);

            width: 0;
            height: 0;

            border-right: var(--msg-tail-size) solid var(--msg-out-bg);
            border-top: var(--msg-tail-size) solid transparent;
            border-bottom: var(--msg-tail-size) solid transparent;
        }

        .nickname-strip {
            color: var(--msg-out-strip-fg);
            background: var(--msg-out-strip-bg);
        }
    }
}

/* Dark mode overrides */
.dark-mode {
    --msg-in-bg: #1f7e38;
    --msg-in-strip-bg: #155b28;
    --msg-in-strip-fg: #d6ffe0;

    --msg-out-bg: #205c8d;
    --msg-out-strip-bg: #163e63;
    --msg-out-strip-fg: #d6ecff;

    --msg-fg: #f3f4f6;
    --msg-timestamp: #a1a1aa;
}