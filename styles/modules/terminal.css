/* =========================================
    Module: Terminal
========================================= */

:root {
    --term-icon-size: 48px;
    --term-icon-margin: 1rem;
    --term-icon-offset: 1rem;
    --term-icon-z-index: 1000;
    --term-icon-radius: 4px;
    --term-icon-border-width: 1px;
    --term-icon-hover-shadow: 0 0 3px;

    --terminal-radius: 8px;
    --terminal-border-width: 1px;
    --terminal-border-colour: rgba(0, 0, 0, 0.3);

    --terminal-pad: 0.5rem;

    --terminal-header-height: 22px;
    --terminal-header-pad-inline: 8px;
    --terminal-header-font-size: calc(11px * var(--kc-text-scale));
    --terminal-header-z-index: 1;

    --terminal-controls-gap: 6px;
    --terminal-btn-font-size: calc(11px * var(--kc-text-scale));
    --terminal-btn-line-height: 1;
    --terminal-btn-hover-scale: 1.2;
    --terminal-btn-hover-transition: 0.2s ease;

    --terminal-btn-symbol-font-size: calc(10px * var(--kc-text-scale));
    --terminal-btn-symbol-font-weight: 700;

    --terminal-btn-close-colour: #8b0000;
    --terminal-btn-toggle-colour: #b8860b;
    --terminal-btn-float-colour: #006400;
}

.xterm {
    background: var(--term-bg);
    height: 100%;

    .xterm-viewport {
        background: var(--term-bg);
    }

    .composition-view {
        background: var(--term-bg);
    }
}

/* Terminal Icon */
#term-icon {
    display: none;

    position: absolute;
    top: var(--term-icon-offset);
    left: var(--term-icon-offset);
    z-index: var(--term-icon-z-index);

    width: var(--term-icon-size);
    height: var(--term-icon-size);
    margin: var(--term-icon-margin);

    cursor: grab;
    user-select: none;

    image-rendering: pixelated;

    box-shadow: var(--frame-box-shadow);
    border: var(--term-icon-border-width) solid var(--frame-bg-colour);
    border-radius: var(--term-icon-radius);

    &:hover {
        filter: drop-shadow(var(--term-icon-hover-shadow) var(--accent));
    }
}

/* ====================================
    Terminal Window Frame & Header
==================================== */

#terminal-window {
    display: inline-block;
    position: relative;

    width: 100%;
    max-width: 100%;

    border-radius: var(--terminal-radius);
    overflow: hidden;

    font-family: "Courier New", Courier, "Lucida Console", monospace;

    background: var(--term-bg);
    box-shadow: var(--frame-box-shadow);
    border: var(--terminal-border-width) solid var(--terminal-border-colour);
}

#term {
    width: 100%;
    height: 100%;
    overflow: hidden;
}

:is(#terminal-scroll, #terminal-wrapper, #terminal-content) {
    padding: var(--terminal-pad);
}

#terminal-scroll,
#terminal-wrapper {
    background: var(--term-bg);
    overflow: hidden;
}

#terminal-header {
    height: var(--terminal-header-height);

    display: flex;
    align-items: center;
    justify-content: space-between;

    position: sticky;
    top: 0;
    z-index: var(--terminal-header-z-index);

    background: var(--term-header-bg);
    color: var(--term-header-fg);

    padding: 0 var(--terminal-header-pad-inline);
    font-size: var(--terminal-header-font-size);

    user-select: none;
}

.window-controls {
    display: flex;
    gap: var(--terminal-controls-gap);

    .btn {
        position: relative;

        cursor: pointer;
        user-select: none;

        font-size: var(--terminal-btn-font-size);
        line-height: var(--terminal-btn-line-height);

        transition: transform var(--terminal-btn-hover-transition);

        &:hover {
            transform: scale(var(--terminal-btn-hover-scale));
        }

        &::after {
            content: "";
            position: absolute;

            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);

            font-size: var(--terminal-btn-symbol-font-size);
            font-weight: var(--terminal-btn-symbol-font-weight);

            opacity: 0;
            pointer-events: none;

            transition: opacity var(--terminal-btn-hover-transition);
        }

        &:hover::after {
            opacity: 1;
        }

        &.close::after {
            content: "×";
            color: var(--terminal-btn-close-colour);
        }

        &.toggle-view::after {
            content: "–";
            color: var(--terminal-btn-toggle-colour);
        }

        &.float::after {
            content: "+";
            color: var(--terminal-btn-float-colour);
        }
    }
}

.window-title {
    flex: 1;
    margin-left: auto;
    margin-right: auto;

    text-align: center;

    font-family: inherit;
    font-weight: 700;
    font-size: var(--terminal-header-font-size);

    color: var(--term-title);

    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}